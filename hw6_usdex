# 判斷最近1日是否為指定天數內的美元-台幣匯率低點
# 使用方式: 於參數設定修改各項參數值，判斷最近1日是否為指定天數內的低點

import yfinance as yf
import pandas as pd


def get_usdex(slot = '5d'):
    
    # crawl price data and save it to df
    exdData = yf.Ticker('USDTWD=X').history(period = slot)
    exdf = pd.DataFrame(data = exdData)
    
    exdf.reset_index(inplace=True)
    exdf['Date'] = pd.to_datetime(exdf['Date'],
                                  format = '%Y-%m-%d')
    exdf.set_index(['Date'], inplace = True)
    
    return exdf

def usdex_point(exdf, day = 5):
    # 判斷當天收盤價第4欄(-1, 3)是否小於倒數day天中最小值
    low_point = False
    if exdf.iloc[-1, 3] >= exdf.iloc[-day:, 3].min():
        low_point = True
        print('今天不是最低點')
    else:
        print('今天是最低點')
        
    return low_point

#參數設定
SLOT = '5d'  #資料爬取區間
DAY = 5 #指定天數

if __name__ == '__main__':
    # SP500前幾大股票
    EXDF = get_usdex(SLOT)
    
    LOW_POINT = usdex_point(EXDF, DAY)

    LOW_POINT

#驗證正確性
""" 
EXDF['Close'].tail(DAY)

"""
